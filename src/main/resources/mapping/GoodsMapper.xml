<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.mapper.GoodsMapper">

    <insert id="savePic" parameterType="com.example.demo.vo.request.PicRequestVO" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
        insert into pic values(null, #{userId}, #{path}, now())
    </insert>

    <insert id="saveGoods" useGeneratedKeys="true" parameterType="com.example.demo.vo.request.GoodsRequestVO" keyColumn="id" keyProperty="id">
        insert into goods values (null, #{userId}, #{title}, #{comment}, now(), now())
    </insert>

    <select id="getGoodsByLikeTitle" resultType="com.example.demo.entity.Goods">
        select id, userId, title, comment from goods where title like concat ('%', #{title}, '%')
        order by createTime desc
    </select>

    <select id="getPicByIds" resultType="com.example.demo.entity.Pic">
        select id, userId, path from pic
        where userId in
        <foreach  item="ids" collection="list" index="index"  open="(" separator="," close=")">
            #{userIds}
        </foreach>
    </select>

    <select id="getFocusUserGoodsByUserId" resultType="com.example.demo.entity.Goods">
        select id, userId, title, comment from goods
        where userId in
        <foreach  item="ids" collection="list" index="index"  open="(" separator="," close=")">
            #{userIds}
        </foreach>
        order by createTime desc
    </select>
</mapper>
